<script type="text/javascript">

	async function applySetting(setting, mode){
		
		const api_url = "{{api_url}}";

		let formData = new FormData();
		formData.append('mode', mode);

		const response = await fetch(api_url+"/settings?setting="+setting,{
			method: 'POST',
			body: formData,
			headers: {
			"accept": "application/json",
			"Access-Control-Allow-Origin":"*",
			"Access-Control-Allow-Headers": "Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With"}
		});

		try{
			json = await response.json();
			setting_status(json);
		}catch(e){
			setting_status(array(status => 0, message => 'Connection failed'));
		}
	}

    function setting_status(data){
        if(data.success == 1){
            color = 'success'
        }else{
            color = 'danger'
        }
        const message = data.message;
		document.getElementById('setting_status').innerHTML = `
			<div class="alert alert-dismissable alert-${color}">
			${message}
			<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
			</div>
		`;
	}

</script>



<div class="panel panel-default">
    <div class="panel-heading"><h2>Settings</h2></div>
    <div class="panel-body">
        
        <div class="alert alert-info">
            <h3>Settings</h3>
            <p>You can edit settings here</p>
        </div>

        <div class="row">						
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-12">
                        <label class="control-label">Application Mode</label>
                        <button class="btn btn-success btn-sm" type="button" onclick="applySetting('app_mode','PRODUCTION');">Production</button>
                        <button class="btn btn-danger btn-sm" type="button" onclick="applySetting('app_mode','DEVELOPMENT');">Development</button>
                    </div>
                    <div class="col-lg-12">
                        <label class="control-label">Cronjob</label>
                        <button class="btn btn-success btn-sm" type="button" onclick="applySetting('cron','start');">Start</button>
                        <button class="btn btn-danger btn-sm" type="button" onclick="applySetting('cron','stop');">Stop</button>
                    </div>
                    <div class="col-lg-12">
                        <div id="setting_status"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>